import ElectricPower
import Resistor
import DifferentialPair
import ElectricSignal

from "parts/BOOMELE_AV_5/BOOMELE_AV_5.ato" import BOOMELE_AV_5_package
from "parts/HOOYA_DIN_323PP/HOOYA_DIN_323PP.ato" import HOOYA_DIN_323PP_package
from "parts/HOOYA_DIN_327/HOOYA_DIN_327.ato" import HOOYA_DIN_327_package
from "parts/SHOU_HAN_PJ_320D/SHOU_HAN_PJ_320D.ato" import SHOU_HAN_PJ_320D_package
from "parts/Texas_Instruments_NE5532ADR/Texas_Instruments_NE5532ADR.ato" import Texas_Instruments_NE5532ADR_package
from "parts/Neutrik_NCJ6FA_H/Neutrik_NCJ6FA_H.ato" import Neutrik_NCJ6FA_H_package

# System Audio Analog Electrical Balanced XLR XLR_c

module XLRBalancedSystemAudioStereoOutput:
    stereo = new SystemAudioStereo
    xlr_balanced_l = new XLR3HeaderBalanced
    xlr_balanced_r = new XLR3HeaderBalanced

    stereo.l ~ xlr_balanced_l.balanced.audio
    stereo.r ~ xlr_balanced_r.balanced.audio

# ------------------------------------------------------------------------------
# INTERFACES
# ------------------------------------------------------------------------------
interface SystemAudioStereo:
    l = new AudioChannel
    r = new AudioChannel

interface SystemAudioMono:
    line = new AudioChannel

interface SystemAudioDolby5_1:
    front_left = new AudioChannel
    front_right = new AudioChannel
    center = new AudioChannel
    subwoofer = new AudioChannel
    surround_left = new AudioChannel
    surround_right = new AudioChannel

interface AudioChannel:
    pass

interface DMX:
    # What use is DMX if just one diff pair?
    data = new DifferentialPair


interface AudioBalanced:
    audio = new AudioChannel
    dp = new DifferentialPair
    dp.p.reference ~ dp.n.reference

interface AudioSingleEnded:
    audio = new AudioChannel
    line = new ElectricSignal

# ------------------------------------------------------------------------------
# XLR CONNECTORS
# ------------------------------------------------------------------------------
module XLR3Header:
    """
        XLR 3 Pin Male Header
    """
    signal pin1
    signal pin2
    signal pin3
    signal gnd

    package = new HOOYA_DIN_327_package
    package.1 ~ pin1
    package.2 ~ pin2
    package.3 ~ pin3
    package.G ~ gnd

module XLR3HeaderBalanced:
    """
        XLR 3 Pin Male Header wired for one balanced audio channel
    """
    xlr3_header = new XLR3Header
    balanced = new AudioBalanced
    balanced.dp.p.line ~ xlr3_header.pin2
    balanced.dp.n.line ~ xlr3_header.pin3
    balanced.dp.p.reference.gnd ~ xlr3_header.pin1

module XLR3Receptacle:
    """
        XLR 3 Pin Female Socket Receptacle
    """
    signal pin1
    signal pin2
    signal pin3
    signal gnd

    package = new HOOYA_DIN_323PP_package
    package.1 ~ pin1
    package.2 ~ pin2
    package.3 ~ pin3
    package.G ~ gnd

module XLR3ReceptacleBalanced:
    """
        XLR 3 Pin Female Socket Receptacle wired for one balanced audio channel
    """
    xlr3_receptacle = new XLR3Receptacle
    balanced = new AudioBalanced
    balanced.dp.p.line ~ xlr3_receptacle.pin2
    balanced.dp.n.line ~ xlr3_receptacle.pin3
    balanced.dp.p.reference.gnd ~ xlr3_receptacle.pin1

module XLR3ReceptacleDMX:
    xlr3_receptacle = new XLR3Receptacle
    dmx = new DMX
    dmx.data.p.line ~ xlr3_receptacle.pin3
    dmx.data.n.line ~ xlr3_receptacle.pin2
    dmx.data.p.reference.gnd ~ xlr3_receptacle.pin1
    dmx.data.n.reference.gnd ~ xlr3_receptacle.pin1

module XLR3TRSReceptacle:
    signal pin1
    signal pin2
    signal pin3
    signal gnd
    signal tip
    signal ring
    signal sleeve

    package = new Neutrik_NCJ6FA_H_package
    package.1 ~ pin1
    package.2 ~ pin2
    package.3 ~ pin3
    package.G ~ gnd
    package.T ~ tip
    package.R ~ ring
    package.S ~ sleeve

module XLR3TRSReceptacleBalanced:
    xlr3_trs_receptacle = new XLR3TRSReceptacle
    balanced = new AudioBalanced
    # XLR
    balanced.dp.p.line ~ xlr3_trs_receptacle.pin3
    balanced.dp.n.line ~ xlr3_trs_receptacle.pin2
    balanced.dp.p.reference.gnd ~ xlr3_trs_receptacle.pin1
    # TRS
    balanced.dp.p.line ~ xlr3_trs_receptacle.tip
    balanced.dp.n.line ~ xlr3_trs_receptacle.ring
    balanced.dp.p.reference.gnd ~ xlr3_trs_receptacle.sleeve

# ------------------------------------------------------------------------------
# RCA CONNECTORS
# ------------------------------------------------------------------------------
module RCAReceptacle:
    signal inner_sleeve
    signal outer_shell

    package = new BOOMELE_AV_5_package #TODO: Please someone find a non-yellow rca
    package.1 ~ inner_sleeve
    package.2 ~ outer_shell

module RCAReceptacleSingleEnded from RCAReceptacle:
    line = new ElectricSignal
    line.line ~ inner_sleeve
    line.reference.gnd ~ outer_shell

# ------------------------------------------------------------------------------
# TRS CONNECTORS
# ------------------------------------------------------------------------------
module TRSReceptacle:
    signal tip
    signal ring
    signal sleeve

    package = new SHOU_HAN_PJ_320D_package
    package.1 ~ sleeve
    package.2 ~ sleeve
    package.3 ~ ring
    package.4 ~ tip

module TRSReceptacleBalanced:
    # Balanced
    audio = new AudioChannel
    trs = new TRSReceptacle
    balanced = new DifferentialPair
    balanced.p.line ~ trs.tip
    balanced.n.line ~ trs.ring
    balanced.p.reference.gnd ~ trs.sleeve
    balanced.n.reference.gnd ~ trs.sleeve

module TRSReceptacleStereo:
    # Stereo
    stereo = new SystemAudioStereo
    trs = new TRSReceptacle
    left = new ElectricSignal
    right = new ElectricSignal
    left.line ~ trs.tip
    right.line ~ trs.ring
    left.reference.gnd ~ trs.sleeve
    right.reference.gnd ~ trs.sleeve

module TRRSReceptacle:
    """
        TRRS Receptacle, Ring 1 is nearest to the tip
    """
    signal tip
    signal ring1
    signal ring2
    signal sleeve

    package = new SHOU_HAN_PJ_320D_package
    package.1 ~ sleeve
    package.2 ~ ring2
    package.3 ~ ring1
    package.4 ~ tip

module TRRSReceptacleSingleEnded:
    trrs = new TRRSReceptacle
    stereo = new SystemAudioStereo
    microphone = new AudioChannel
    trrs = new TRRSReceptacle

    single_ended_audios = new AudioSingleEnded[3]
    # trrs.tip ~ microphone.line
    # trrs.ring1 ~ left.line
    # trrs.ring2 ~ right.line
    trrs.sleeve ~ microphone.reference.gnd
    trrs.sleeve ~ stereo.l.reference.gnd
    trrs.sleeve ~ stereo.r.reference.gnd

module TRRSReceptacleSingleEndedMicrophoneAndStereo:
    trrs = new TRRSReceptacleSingleEnded
    stereo = new SystemAudioStereo
    microphone = new AudioChannel

    # trrs.tip ~ microphone.line
